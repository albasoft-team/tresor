{% extends 'base.html.twig' %}
{% block stylesheets %}
    <style>
        .bootstrap-select>.dropdown-toggle {
            padding-right: 25px;
            z-index: 1;
            border: 1px solid #CCC;
            color: black;
        }
        .bootstrap-select:not([class*=col-]):not([class*=form-control]):not(.input-group-btn) {
            width: auto !important;
            margin-right: 25px;
        }
        .bootstrap-select.btn-group .dropdown-menu li {
            position: relative;
            font-size: 16px;
            color: #3277b2;
        }
        .bootstrap-select.btn-group .dropdown-menu li a.opt {
            position: relative;
            padding-left: 2.25em;
            font-size: smaller;
        }
    </style>
{% endblock %}

{% block analyser %}
    <div class="box box-primary">
        <div class="box-body" ng-controller="analyzeController">
            <form id="formAnalyse"   class="form-horizontal" name="myForm" style="margin-bottom: 15px">
                <div class="form-group">
                    <label for="numcompte">Composant à analyser:</label>
                    <select ng-model="formData.composant"  name="composant"  class="form-control" id="numcompte" required>
                        <option></option>
                        {% for comp in composants %}
                            <option value="{{ comp.id}}|{{ comp.name }}">{{ comp.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="axe">Choisir un axe :</label>
                    <select  ng-model="formData.axe" name="axe"  class="form-control select" id="axe" required>
                        <option></option>
                        {% for axe in axes  %}
                            <option class="option" value="{{ axe.code }}|{{ axe.name }}">{{ axe.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label for="axe">Choisir un niveau</label>
                    <select  ng-model="formData.level" name="niveau"  class="form-control select" id="axe" required>
                        <option></option>
                        {% for level in levels %}
                            <option value="{{ level.niveau }}">{{ level.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="form-group">
                    <label>Date début:</label>

                    <div class="input-group date">
                        <div class="input-group-addon">
                            <i class="fa fa-calendar"></i>
                        </div>
                        <input id="startDatePicker" type="text" ng-model="formData.startDate" name="startDate" class=" form-control pull-right">
                    </div>
                    <!-- /.input group -->
                </div>
                <div class="form-group">
                    <label>Date fin:</label>

                    <div class="input-group date">
                        <div class="input-group-addon">
                            <i class="fa fa-calendar"></i>
                        </div>
                        <input id="endDatePicker"  type="text" ng-model="formData.endDate" name="endDate"  class=" form-control pull-right">
                    </div>
                    <!-- /.input group -->
                </div>
                <div class="form-group">
                    <button type="button" ng-click="myForm.$valid && analyser(formData)" class="btn btn-primary">Analyser</button>
                </div>

            </form>
        </div>
    </div>
    {% endblock %}

{% block body %}
    <div ng-controller="analyzeController">
        <span us-spinner="{radius:30, width:8, length: 16}"></span>
        <div id="container" style="width:100%; height:550px;"></div>

        <div class="box" style="margin-top: 10px!important;">
            <div  class="box-body" ng-show="postecomptabelNbCheque.length > 0">
                <table id="tableauResult" class="table table-bordered table-striped">
                    <thead style="background-color: #3c8dbc;color: white">
                    <tr>
                        <th>Titulaire</th>
                        <th>Nb Chèques</th>
                        <th>Montant</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="nb in postecomptabelNbCheque">
                        <td>[[ nb.name ]]</td>
                        <td class="nombreMask text-right">[[ nb.nbChq ]]</td>
                        <td class="nombreMask text-right">[[ nb.Mtotal ]]</td>
                    </tr>

                    </tbody>
                    <tfoot>
                    <tr>
                        <td style="font-size: 20px;" class="text-center"><strong>TOTAL GENERAL</strong></td>
                        <td style="font-size: 20px" class="nombreMask text-right"><strong>[[nbChqTotal]]</strong></td>
                        <td style="font-size: 20px" class="nombreMask text-right"><strong>[[MntTotal]]</strong></td>
                    </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <did id="chartBlock">
            <div style="margin-top: 10px" class="col-lg-6 col-md-6 col-xs-12">
                <div class="" id="chartContainer"></div>
            </div>
            <div style="margin-top: 10px"  class="col-lg-6 col-md-6 col-xs-12" >
                <div id="pieContainer"></div>
            </div>
        </did>

        {#<div class="" id="chartContainer2"></div>#}
    </div>
{% endblock %}

{% block javascripts %}
        <script>
            window.onload = function () {
                $('#startDatePicker').datepicker({
                    format : 'dd/mm/yyyy',
                    language: 'fr',
                    todayHighlight: true,
                    autoclose: true
                }).on('changeDate', function (e) {
                    $('#formAnalyse').formValidation('revalidateField', 'startDate');
                });
                 $('#endDatePicker').datepicker({
                    format : 'dd/mm/yyyy',
                    language: 'fr',
                    todayHighlight: true,
                    autoclose: true
                }).on('changeDate', function (e) {
                    $('#formAnalyse').formValidation('revalidateField', 'endDate');
                });


            };
//            $(document).ready(function () {
//                $('.select').selectpicker();
//                console.log('sfvsdf');
//                $('.highcharts-credits').text('');
//                //Date picker
//
//
//            });

        </script>
{% endblock %}